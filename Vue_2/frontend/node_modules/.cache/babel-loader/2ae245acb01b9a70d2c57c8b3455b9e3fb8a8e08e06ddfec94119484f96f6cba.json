{"ast":null,"code":"import axios from '../axios';\nexport default {\n  data() {\n    return {\n      favorites: [],\n      loadingFavorites: true,\n      loading: {}\n    };\n  },\n  mounted() {\n    this.loadFavorites();\n  },\n  methods: {\n    async loadFavorites() {\n      this.loadingFavorites = true;\n      try {\n        const res = await axios.get('/favorites');\n        if (res.ok) {\n          this.favorites = res.data;\n        }\n      } catch (error) {\n        console.error('加载收藏列表失败', error);\n        this.$message.error('加载收藏列表失败');\n      } finally {\n        this.loadingFavorites = false;\n      }\n    },\n    async removeFavorite(itemId) {\n      this.loading[itemId] = true;\n      try {\n        await axios.delete(`/favorites/${itemId}`);\n        this.$message.success('取消收藏成功');\n        // 从列表中移除\n        this.favorites = this.favorites.filter(item => item.id !== itemId);\n      } catch (error) {\n        console.error('取消收藏失败', error);\n        this.$message.error('取消收藏失败');\n      } finally {\n        this.loading[itemId] = false;\n      }\n    },\n    formatDate(dateString) {\n      if (!dateString) return '';\n      const date = new Date(dateString);\n      return date.toLocaleDateString();\n    }\n  }\n};","map":{"version":3,"names":["axios","data","favorites","loadingFavorites","loading","mounted","loadFavorites","methods","res","get","ok","error","console","$message","removeFavorite","itemId","delete","success","filter","item","id","formatDate","dateString","date","Date","toLocaleDateString"],"sources":["D:\\21626\\MyFiles\\files\\2025fall\\SE\\Vue_2\\frontend\\src\\views\\Favorites.vue"],"sourcesContent":["<template>\n  <div class=\"container\">\n    <div class=\"card mt-5\">\n      <div class=\"card-header bg-primary text-white\">\n        <h4 class=\"mb-0\">我的收藏</h4>\n      </div>\n      <div class=\"card-body\">\n        <!-- 收藏列表 -->\n        <div class=\"row\" v-if=\"favorites.length > 0\">\n          <div class=\"col-md-4 mb-4\" v-for=\"item in favorites\" :key=\"item.id\">\n            <div class=\"card item-card\">\n              <img \n                :src=\"item.image_path ? `/static/${item.image_path}` : '/static/images/default.jpg'\" \n                class=\"card-img-top item-image\" \n                :alt=\"item.title\"\n              >\n              <div class=\"card-body\">\n                <h5 class=\"card-title\">{{ item.title }}</h5>\n                <p class=\"card-text text-danger font-weight-bold\">¥{{ item.price }}</p>\n                <p class=\"card-text text-muted\">{{ formatDate(item.created_at) }}</p>\n                <div class=\"d-flex gap-2\">\n                  <router-link \n                    :to=\"{ name: 'ItemDetail', params: { id: item.id } }\" \n                    class=\"btn btn-primary btn-sm-1\"\n                  >\n                    查看详情\n                  </router-link>\n                  <button \n                    class=\"btn btn-outline-danger btn-sm\"\n                    @click=\"removeFavorite(item.id)\"\n                    :disabled=\"loading[item.id]\"\n                  >\n                    <i class=\"fas fa-heart\"></i>\n                    <span v-if=\"loading[item.id]\" class=\"spinner-border spinner-border-sm ml-1\"></span>\n                    取消收藏\n                  </button>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n        \n        <div class=\"alert alert alert-info text-center py-5\" v-else-if=\"!loadingFavorites\">\n          <i class=\"fas fa-heart text-danger fa-3x mb-3\"></i>\n          <p>您还没有收藏任何商品</p>\n          <router-link to=\"/\" class=\"btn btn-primary mt-2\">去浏览商品</router-link>\n        </div>\n        \n        <div class=\"text-center py-5\" v-else>\n          <div class=\"spinner-border text-primary\" role=\"status\">\n            <span class=\"sr-only\">Loading...</span>\n          </div>\n          <p class=\"mt-2\">加载中...</p>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport axios from '../axios';\n\nexport default {\n  data() {\n    return {\n      favorites: [],\n      loadingFavorites: true,\n      loading: {}\n    };\n  },\n  mounted() {\n    this.loadFavorites();\n  },\n  methods: {\n    async loadFavorites() {\n      this.loadingFavorites = true;\n      try {\n        const res = await axios.get('/favorites');\n        if (res.ok) {\n          this.favorites = res.data;\n        }\n      } catch (error) {\n        console.error('加载收藏列表失败', error);\n        this.$message.error('加载收藏列表失败');\n      } finally {\n        this.loadingFavorites = false;\n      }\n    },\n    async removeFavorite(itemId) {\n      this.loading[itemId] = true;\n      try {\n        await axios.delete(`/favorites/${itemId}`);\n        this.$message.success('取消收藏成功');\n        // 从列表中移除\n        this.favorites = this.favorites.filter(item => item.id !== itemId);\n      } catch (error) {\n        console.error('取消收藏失败', error);\n        this.$message.error('取消收藏失败');\n      } finally {\n        this.loading[itemId] = false;\n      }\n    },\n    formatDate(dateString) {\n      if (!dateString) return '';\n      const date = new Date(dateString);\n      return date.toLocaleDateString();\n    }\n  }\n};\n</script>\n\n<style scoped>\n.item-card {\n  transition: transform 0.2s;\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n}\n.item-card:hover {\n  transform: translateY(-5px);\n  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);\n}\n.item-image {\n  height: 200px;\n  object-fit: cover;\n}\n.card-body {\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n}\n.card-title {\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n}\n</style>\n"],"mappings":"AA4DA,OAAOA,KAAI,MAAO,UAAU;AAE5B,eAAe;EACbC,IAAIA,CAAA,EAAG;IACL,OAAO;MACLC,SAAS,EAAE,EAAE;MACbC,gBAAgB,EAAE,IAAI;MACtBC,OAAO,EAAE,CAAC;IACZ,CAAC;EACH,CAAC;EACDC,OAAOA,CAAA,EAAG;IACR,IAAI,CAACC,aAAa,CAAC,CAAC;EACtB,CAAC;EACDC,OAAO,EAAE;IACP,MAAMD,aAAaA,CAAA,EAAG;MACpB,IAAI,CAACH,gBAAe,GAAI,IAAI;MAC5B,IAAI;QACF,MAAMK,GAAE,GAAI,MAAMR,KAAK,CAACS,GAAG,CAAC,YAAY,CAAC;QACzC,IAAID,GAAG,CAACE,EAAE,EAAE;UACV,IAAI,CAACR,SAAQ,GAAIM,GAAG,CAACP,IAAI;QAC3B;MACF,EAAE,OAAOU,KAAK,EAAE;QACdC,OAAO,CAACD,KAAK,CAAC,UAAU,EAAEA,KAAK,CAAC;QAChC,IAAI,CAACE,QAAQ,CAACF,KAAK,CAAC,UAAU,CAAC;MACjC,UAAU;QACR,IAAI,CAACR,gBAAe,GAAI,KAAK;MAC/B;IACF,CAAC;IACD,MAAMW,cAAcA,CAACC,MAAM,EAAE;MAC3B,IAAI,CAACX,OAAO,CAACW,MAAM,IAAI,IAAI;MAC3B,IAAI;QACF,MAAMf,KAAK,CAACgB,MAAM,CAAC,cAAcD,MAAM,EAAE,CAAC;QAC1C,IAAI,CAACF,QAAQ,CAACI,OAAO,CAAC,QAAQ,CAAC;QAC/B;QACA,IAAI,CAACf,SAAQ,GAAI,IAAI,CAACA,SAAS,CAACgB,MAAM,CAACC,IAAG,IAAKA,IAAI,CAACC,EAAC,KAAML,MAAM,CAAC;MACpE,EAAE,OAAOJ,KAAK,EAAE;QACdC,OAAO,CAACD,KAAK,CAAC,QAAQ,EAAEA,KAAK,CAAC;QAC9B,IAAI,CAACE,QAAQ,CAACF,KAAK,CAAC,QAAQ,CAAC;MAC/B,UAAU;QACR,IAAI,CAACP,OAAO,CAACW,MAAM,IAAI,KAAK;MAC9B;IACF,CAAC;IACDM,UAAUA,CAACC,UAAU,EAAE;MACrB,IAAI,CAACA,UAAU,EAAE,OAAO,EAAE;MAC1B,MAAMC,IAAG,GAAI,IAAIC,IAAI,CAACF,UAAU,CAAC;MACjC,OAAOC,IAAI,CAACE,kBAAkB,CAAC,CAAC;IAClC;EACF;AACF,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}