{"ast":null,"code":"import axios from './axios';\nexport default {\n  data() {\n    return {\n      isLoggedIn: false,\n      currentUser: {}\n    };\n  },\n  mounted() {\n    // 检查登录状态\n    this.checkLoginStatus();\n  },\n  methods: {\n    async checkLoginStatus() {\n      const token = localStorage.getItem('access_token');\n      if (token) {\n        this.isLoggedIn = true;\n        this.getUserInfo();\n      } else {\n        this.isLoggedIn = false;\n        this.currentUser = {};\n      }\n    },\n    async getUserInfo() {\n      try {\n        const res = await axios.get('/auth/me');\n        if (res.ok) {\n          this.currentUser = res.data;\n        }\n      } catch (error) {\n        console.error('获取用户信息失败', error);\n        localStorage.removeItem('access_token');\n        this.isLoggedIn = false;\n      }\n    },\n    async logout() {\n      try {\n        await axios.post('/auth/logout');\n      } catch (error) {\n        console.error('登出失败', error);\n      } finally {\n        localStorage.removeItem('access_token');\n        this.isLoggedIn = false;\n        this.currentUser = {};\n        this.$router.push('/');\n      }\n    }\n  }\n};","map":{"version":3,"names":["axios","data","isLoggedIn","currentUser","mounted","checkLoginStatus","methods","token","localStorage","getItem","getUserInfo","res","get","ok","error","console","removeItem","logout","post","$router","push"],"sources":["D:\\21626\\MyFiles\\files\\2025fall\\SE\\Vue_2\\frontend\\src\\App.vue"],"sourcesContent":["<template>\n  <div id=\"app\">\n    <!-- 导航栏 -->\n    <nav class=\"navbar navbar-expand-lg navbar-light bg-light\">\n      <div class=\"container\">\n        <router-link to=\"/\" class=\"navbar-brand\">校内二手市场</router-link>\n        \n        <div class=\"collapse navbar-collapse\" id=\"navbarNav\">\n          <ul class=\"navbar-nav mr-auto\">\n            <li class=\"nav-item\">\n              <router-link to=\"/\" class=\"nav-link\">首页</router-link>\n            </li>\n            <li class=\"nav-item\">\n              <router-link to=\"/publish\" class=\"nav-link\">发布商品</router-link>\n            </li>\n          </ul>\n          \n          <ul class=\"navbar-nav\">\n            <li class=\"nav-item\">\n              <router-link to=\"/favorites\" class=\"nav-link\">\n                <i class=\"fas fa-heart\"></i> 收藏\n              </router-link>\n            </li>\n            <li class=\"nav-item\">\n              <router-link to=\"/messages\" class=\"nav-link\">\n                <i class=\"fas fa-comment\"></i> 消息\n              </router-link>\n            </li>\n            <li class=\"nav-item dropdown\" v-if=\"isLoggedIn\">\n              <a class=\"nav-link dropdown-toggle\" href=\"#\" id=\"navbarDropdown\" role=\"button\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\n                {{ currentUser.username }}\n              </a>\n              <div class=\"dropdown-menu\" aria-labelledby=\"navbarDropdown\">\n                <router-link to=\"/user-center\" class=\"dropdown-item\">个人中心</router-link>\n                <a class=\"dropdown-item\" href=\"#\" @click=\"logout\">退出登录</a>\n              </div>\n            </li>\n            <li class=\"nav-item\" v-if=\"!isLoggedIn\">\n              <router-link to=\"/login\" class=\"nav-link\">登录</router-link>\n            </li>\n            <li class=\"nav-item\" v-if=\"!isLoggedIn\">\n              <router-link to=\"/register\" class=\"nav-link\">注册</router-link>\n            </li>\n          </ul>\n        </div>\n      </div>\n    </nav>\n    \n    <!-- 主要内容 -->\n    <div class=\"container mt-4\">\n      <router-view />\n    </div>\n    \n    <!-- 页脚 -->\n    <footer class=\"bg-light py-3 mt-4\">\n      <div class=\"container text-center\">\n        <p class=\"mb-0\">© 2023 校内二手市场. 保留所有权利.</p>\n      </div>\n    </footer>\n  </div>\n</template>\n\n<script>\nimport axios from './axios';\n\nexport default {\n  data() {\n    return {\n      isLoggedIn: false,\n      currentUser: {}\n    };\n  },\n  mounted() {\n    // 检查登录状态\n    this.checkLoginStatus();\n  },\n  methods: {\n    async checkLoginStatus() {\n      const token = localStorage.getItem('access_token');\n      if (token) {\n        this.isLoggedIn = true;\n        this.getUserInfo();\n      } else {\n        this.isLoggedIn = false;\n        this.currentUser = {};\n      }\n    },\n    async getUserInfo() {\n      try {\n        const res = await axios.get('/auth/me');\n        if (res.ok) {\n          this.currentUser = res.data;\n        }\n      } catch (error) {\n        console.error('获取用户信息失败', error);\n        localStorage.removeItem('access_token');\n        this.isLoggedIn = false;\n      }\n    },\n    async logout() {\n      try {\n        await axios.post('/auth/logout');\n      } catch (error) {\n        console.error('登出失败', error);\n      } finally {\n        localStorage.removeItem('access_token');\n        this.isLoggedIn = false;\n        this.currentUser = {};\n        this.$router.push('/');\n      }\n    }\n  }\n};\n</script>\n\n<style>\n#app {\n  font-family: Avenir, Helvetica, Arial, sans-serif;\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n  text-align: center;\n  color: #2c3e50;\n}\n\n.navbar {\n  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);\n}\n\n.nav-link {\n  cursor: pointer;\n}\n\nfooter {\n  margin-top: auto;\n}\n</style>\n"],"mappings":"AA+DA,OAAOA,KAAI,MAAO,SAAS;AAE3B,eAAe;EACbC,IAAIA,CAAA,EAAG;IACL,OAAO;MACLC,UAAU,EAAE,KAAK;MACjBC,WAAW,EAAE,CAAC;IAChB,CAAC;EACH,CAAC;EACDC,OAAOA,CAAA,EAAG;IACR;IACA,IAAI,CAACC,gBAAgB,CAAC,CAAC;EACzB,CAAC;EACDC,OAAO,EAAE;IACP,MAAMD,gBAAgBA,CAAA,EAAG;MACvB,MAAME,KAAI,GAAIC,YAAY,CAACC,OAAO,CAAC,cAAc,CAAC;MAClD,IAAIF,KAAK,EAAE;QACT,IAAI,CAACL,UAAS,GAAI,IAAI;QACtB,IAAI,CAACQ,WAAW,CAAC,CAAC;MACpB,OAAO;QACL,IAAI,CAACR,UAAS,GAAI,KAAK;QACvB,IAAI,CAACC,WAAU,GAAI,CAAC,CAAC;MACvB;IACF,CAAC;IACD,MAAMO,WAAWA,CAAA,EAAG;MAClB,IAAI;QACF,MAAMC,GAAE,GAAI,MAAMX,KAAK,CAACY,GAAG,CAAC,UAAU,CAAC;QACvC,IAAID,GAAG,CAACE,EAAE,EAAE;UACV,IAAI,CAACV,WAAU,GAAIQ,GAAG,CAACV,IAAI;QAC7B;MACF,EAAE,OAAOa,KAAK,EAAE;QACdC,OAAO,CAACD,KAAK,CAAC,UAAU,EAAEA,KAAK,CAAC;QAChCN,YAAY,CAACQ,UAAU,CAAC,cAAc,CAAC;QACvC,IAAI,CAACd,UAAS,GAAI,KAAK;MACzB;IACF,CAAC;IACD,MAAMe,MAAMA,CAAA,EAAG;MACb,IAAI;QACF,MAAMjB,KAAK,CAACkB,IAAI,CAAC,cAAc,CAAC;MAClC,EAAE,OAAOJ,KAAK,EAAE;QACdC,OAAO,CAACD,KAAK,CAAC,MAAM,EAAEA,KAAK,CAAC;MAC9B,UAAU;QACRN,YAAY,CAACQ,UAAU,CAAC,cAAc,CAAC;QACvC,IAAI,CAACd,UAAS,GAAI,KAAK;QACvB,IAAI,CAACC,WAAU,GAAI,CAAC,CAAC;QACrB,IAAI,CAACgB,OAAO,CAACC,IAAI,CAAC,GAAG,CAAC;MACxB;IACF;EACF;AACF,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}