{"ast":null,"code":"import axios from '../axios';\nexport default {\n  data() {\n    return {\n      activeTab: 'my-items',\n      userInfo: {\n        username: '',\n        email: '',\n        phone: ''\n      },\n      items: [],\n      loading: false,\n      statusLoading: {}\n    };\n  },\n  mounted() {\n    this.loadUserInfo();\n    this.loadMyItems();\n  },\n  methods: {\n    async loadUserInfo() {\n      try {\n        const res = await axios.get('/auth/me');\n        if (res.ok) {\n          this.userInfo = res.data;\n        }\n      } catch (error) {\n        console.error('加载用户信息失败', error);\n      }\n    },\n    async loadMyItems() {\n      this.loading = true;\n      try {\n        const res = await axios.get('/user/items');\n        if (res.ok) {\n          this.items = res.data;\n        }\n      } catch (error) {\n        console.error('加载我的商品失败', error);\n        this.$message.error('加载我的商品失败');\n      } finally {\n        this.loading = false;\n      }\n    },\n    async handleUpdateProfile() {\n      this.loading = true;\n      try {\n        // 这里应该调用更新用户信息的API\n        // 由于后端还没有实现这个API，暂时只显示成功消息\n        this.$message.success('个人资料更新成功');\n      } catch (error) {\n        console.error('更新个人资料失败', error);\n        this.$message.error('更新个人资料失败');\n      } finally {\n        this.loading = false;\n      }\n    },\n    async changeItemStatus(item) {\n      this.statusLoading[item.id] = true;\n      try {\n        const newStatus = item.status === 'available' ? 'sold' : 'available';\n        const res = await axios.put(`/items/${item.id}/status`, {\n          status: newStatus\n        });\n        if (res.ok) {\n          item.status = newStatus;\n          this.$message.success(`商品已${newStatus === 'available' ? '上架' : '下架'}`);\n        }\n      } catch (error) {\n        console.error('更新商品状态失败', error);\n        this.$message.error('更新商品状态失败');\n      } finally {\n        this.statusLoading[item.id] = false;\n      }\n    },\n    getStatusClass(status) {\n      switch (status) {\n        case 'available':\n          return 'bg-success';\n        case 'sold':\n          return 'bg-secondary';\n        case 'reserved':\n          return 'bg-warning';\n        default:\n          return 'bg-light';\n      }\n    },\n    getStatusText(status) {\n      switch (status) {\n        case 'available':\n          return '在售';\n        case 'sold':\n          return '已售出';\n        case 'reserved':\n          return '已预订';\n        default:\n          return '未知状态';\n      }\n    }\n  }\n};","map":{"version":3,"names":["axios","data","activeTab","userInfo","username","email","phone","items","loading","statusLoading","mounted","loadUserInfo","loadMyItems","methods","res","get","ok","error","console","$message","handleUpdateProfile","success","changeItemStatus","item","id","newStatus","status","put","getStatusClass","getStatusText"],"sources":["D:\\21626\\MyFiles\\files\\2025fall\\SE\\Vue_2\\frontend\\src\\views\\UserCenter.vue"],"sourcesContent":["<template>\n  <div class=\"container\">\n    <div class=\"row\">\n      <!-- 侧边栏 -->\n      <div class=\"col-md-3\">\n        <div class=\"card mt-5\">\n          <div class=\"card-header bg-primary text-white\">\n            <h4 class=\"mb-0\">个人中心</h4>\n          </div>\n          <div class=\"list-group list-group-flush\">\n            <a \n              href=\"#\" \n              class=\"list-group-item list-group-item-action active\" \n              aria-current=\"true\"\n              @click.prevent=\"activeTab = 'my-items'\"\n            >\n              我的商品\n            </a>\n            <a \n              href=\"#\" \n              class=\"list-group-item list-group-item-action\"\n              @click.prevent=\"activeTab = 'profile'\"\n            >\n              个人资料\n            </a>\n          </div>\n        </div>\n      </div>\n      \n      <!-- 内容区域 -->\n      <div class=\"col-md-9\">\n        <!-- 我的商品 -->\n        <div v-if=\"activeTab === 'my-items'\">\n          <div class=\"card mt-5\">\n            <div class=\"card-header bg-primary text-white\">\n              <h4 class=\"mb-0\">我的商品</h4>\n            </div>\n            <div class=\"card-body\">\n              <!-- 商品列表 -->\n              <div class=\"row\" v-if=\"items.length > 0\">\n                <div class=\"col-md-4 mb-4\" v-for=\"item in items\" :key=\"item.id\">\n                  <div class=\"card item-card\">\n                    <img \n                      :src=\"item.image_path ? `/static/${item.image_path}` : '/static/images/default.jpg'\" \n                      class=\"card-img-top item-image\" \n                      :alt=\"item.title\"\n                    >\n                    <div class=\"card-body\">\n                      <h5 class=\"card-title\">{{ item.title }}</h5>\n                      <p class=\"card-text text-danger font-weight-bold\">¥{{ item.price }}</p>\n                      <p class=\"card-text\">\n                        <span class=\"badge\" :class=\"getStatusClass(item.status)\">{{ getStatusText(item.status) }}</span>\n                      </p>\n                      <div class=\"d-flex gap-2\">\n                        <router-link \n                          :to=\"{ name: 'ItemDetail', params: { id: item.id } }\" \n                          class=\"btn btn-primary btn-sm flex-1\"\n                        >\n                          查看\n                        </router-link>\n                        <button \n                          class=\"btn btn-outline-secondary btn-sm\"\n                          @click=\"changeItemStatus(item)\"\n                        >\n                          {{ item.status === 'available' ? '下架' : '上架' }}\n                        </button>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n              </div>\n              \n              <div class=\"alert alert-info text-center\" v-else-if=\"!loading\">\n                您还没有发布任何商品\n                <router-link to=\"/publish\" class=\"btn btn-primary btn-sm ml-2\">立即发布</router-link>\n              </div>\n              \n              <div class=\"text-center py-3\" v-else>\n                <div class=\"spinner-border text-primary\" role=\"status\">\n                  <span class=\"sr-only\">Loading...</span>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n        \n        <!-- 个人资料 -->\n        <div v-if=\"activeTab === 'profile'\">\n          <div class=\"card mt-5\">\n            <div class=\"card-header bg-primary text-white\">\n              <h4 class=\"mb-0\">个人资料</h4>\n            </div>\n            <div class=\"card-body\">\n              <form @submit.prevent=\"handleUpdateProfile\">\n                <div class=\"form-group\">\n                  <label for=\"username\">用户名</label>\n                  <input \n                    type=\"text\" \n                    id=\"username\" \n                    v-model=\"userInfo.username\" \n                    class=\"form-control\" \n                    disabled\n                  >\n                </div>\n                \n                <div class=\"form-group\">\n                  <label for=\"email\">邮箱</label>\n                  <input \n                    type=\"email\" \n                    id=\"email\" \n                    v-model=\"userInfo.email\" \n                    class=\"form-control\"\n                  >\n                </div>\n                \n                <div class=\"form-group\">\n                  <label for=\"phone\">手机号</label>\n                  <input \n                    type=\"tel\" \n                    id=\"phone\" \n                    v-model=\"userInfo.phone\" \n                    class=\"form-control\"\n                  >\n                </div>\n                \n                <button \n                  type=\"submit\" \n                  class=\"btn btn-primary\" \n                  :disabled=\"loading\"\n                >\n                  <span v-if=\"loading\" class=\"spinner-border spinner-border-sm mr-2\"></span>\n                  保存修改\n                </button>\n              </form>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport axios from '../axios';\n\nexport default {\n  data() {\n    return {\n      activeTab: 'my-items',\n      userInfo: {\n        username: '',\n        email: '',\n        phone: ''\n      },\n      items: [],\n      loading: false,\n      statusLoading: {}\n    };\n  },\n  mounted() {\n    this.loadUserInfo();\n    this.loadMyItems();\n  },\n  methods: {\n    async loadUserInfo() {\n      try {\n        const res = await axios.get('/auth/me');\n        if (res.ok) {\n          this.userInfo = res.data;\n        }\n      } catch (error) {\n        console.error('加载用户信息失败', error);\n      }\n    },\n    async loadMyItems() {\n      this.loading = true;\n      try {\n        const res = await axios.get('/user/items');\n        if (res.ok) {\n          this.items = res.data;\n        }\n      } catch (error) {\n        console.error('加载我的商品失败', error);\n        this.$message.error('加载我的商品失败');\n      } finally {\n        this.loading = false;\n      }\n    },\n    async handleUpdateProfile() {\n      this.loading = true;\n      try {\n        // 这里应该调用更新用户信息的API\n        // 由于后端还没有实现这个API，暂时只显示成功消息\n        this.$message.success('个人资料更新成功');\n      } catch (error) {\n        console.error('更新个人资料失败', error);\n        this.$message.error('更新个人资料失败');\n      } finally {\n        this.loading = false;\n      }\n    },\n    async changeItemStatus(item) {\n      this.statusLoading[item.id] = true;\n      try {\n        const newStatus = item.status === 'available' ? 'sold' : 'available';\n        const res = await axios.put(`/items/${item.id}/status`, {\n          status: newStatus\n        });\n        \n        if (res.ok) {\n          item.status = newStatus;\n          this.$message.success(`商品已${newStatus === 'available' ? '上架' : '下架'}`);\n        }\n      } catch (error) {\n        console.error('更新商品状态失败', error);\n        this.$message.error('更新商品状态失败');\n      } finally {\n        this.statusLoading[item.id] = false;\n      }\n    },\n    getStatusClass(status) {\n      switch (status) {\n        case 'available':\n          return 'bg-success';\n        case 'sold':\n          return 'bg-secondary';\n        case 'reserved':\n          return 'bg-warning';\n        default:\n          return 'bg-light';\n      }\n    },\n    getStatusText(status) {\n      switch (status) {\n        case 'available':\n          return '在售';\n        case 'sold':\n          return '已售出';\n        case 'reserved':\n          return '已预订';\n        default:\n          return '未知状态';\n      }\n    }\n  }\n};\n</script>\n\n<style scoped>\n.item-card {\n  transition: transform 0.2s;\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n}\n.item-card:hover {\n  transform: translateY(-5px);\n  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);\n}\n.item-image {\n  height: 200px;\n  object-fit: cover;\n}\n.card-body {\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n}\n.card-title {\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n}\n</style>\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}