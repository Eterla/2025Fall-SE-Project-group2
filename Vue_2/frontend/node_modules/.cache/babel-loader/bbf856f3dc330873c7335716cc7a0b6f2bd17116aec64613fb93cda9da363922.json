{"ast":null,"code":"import { createElementVNode as _createElementVNode, createCommentVNode as _createCommentVNode, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, createTextVNode as _createTextVNode, resolveComponent as _resolveComponent, withCtx as _withCtx, createVNode as _createVNode } from \"vue\";\nconst _hoisted_1 = {\n  class: \"container\"\n};\nconst _hoisted_2 = {\n  class: \"card mt-5\"\n};\nconst _hoisted_3 = {\n  class: \"card-body\"\n};\nconst _hoisted_4 = {\n  key: 0,\n  class: \"row\"\n};\nconst _hoisted_5 = {\n  class: \"card item-card\"\n};\nconst _hoisted_6 = [\"src\", \"alt\"];\nconst _hoisted_7 = {\n  class: \"card-body\"\n};\nconst _hoisted_8 = {\n  class: \"card-title\"\n};\nconst _hoisted_9 = {\n  class: \"card-text text-danger font-weight-bold\"\n};\nconst _hoisted_10 = {\n  class: \"card-text text-muted\"\n};\nconst _hoisted_11 = {\n  class: \"d-flex gap-2\"\n};\nconst _hoisted_12 = [\"onClick\", \"disabled\"];\nconst _hoisted_13 = {\n  key: 0,\n  class: \"spinner-border spinner-border-sm ml-1\"\n};\nconst _hoisted_14 = {\n  key: 1,\n  class: \"alert alert alert-info text-center py-5\"\n};\nconst _hoisted_15 = {\n  key: 2,\n  class: \"text-center py-5\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_router_link = _resolveComponent(\"router-link\");\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createElementVNode(\"div\", _hoisted_2, [_cache[7] || (_cache[7] = _createElementVNode(\"div\", {\n    class: \"card-header bg-primary text-white\"\n  }, [_createElementVNode(\"h4\", {\n    class: \"mb-0\"\n  }, \"我的收藏\")], -1 /* CACHED */)), _createElementVNode(\"div\", _hoisted_3, [_createCommentVNode(\" 收藏列表 \"), $data.favorites.length > 0 ? (_openBlock(), _createElementBlock(\"div\", _hoisted_4, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList($data.favorites, item => {\n    return _openBlock(), _createElementBlock(\"div\", {\n      class: \"col-md-4 mb-4\",\n      key: item.id\n    }, [_createElementVNode(\"div\", _hoisted_5, [_createElementVNode(\"img\", {\n      src: item.image_path ? `/static/${item.image_path}` : '/static/images/default.jpg',\n      class: \"card-img-top item-image\",\n      alt: item.title\n    }, null, 8 /* PROPS */, _hoisted_6), _createElementVNode(\"div\", _hoisted_7, [_createElementVNode(\"h5\", _hoisted_8, _toDisplayString(item.title), 1 /* TEXT */), _createElementVNode(\"p\", _hoisted_9, \"¥\" + _toDisplayString(item.price), 1 /* TEXT */), _createElementVNode(\"p\", _hoisted_10, _toDisplayString($options.formatDate(item.created_at)), 1 /* TEXT */), _createElementVNode(\"div\", _hoisted_11, [_createVNode(_component_router_link, {\n      to: {\n        name: 'ItemDetail',\n        params: {\n          id: item.id\n        }\n      },\n      class: \"btn btn-primary btn-sm-1\"\n    }, {\n      default: _withCtx(() => [...(_cache[0] || (_cache[0] = [_createTextVNode(\" 查看详情 \", -1 /* CACHED */)]))]),\n      _: 1 /* STABLE */\n    }, 8 /* PROPS */, [\"to\"]), _createElementVNode(\"button\", {\n      class: \"btn btn-outline-danger btn-sm\",\n      onClick: $event => $options.removeFavorite(item.id),\n      disabled: $data.loading[item.id]\n    }, [_cache[1] || (_cache[1] = _createElementVNode(\"i\", {\n      class: \"fas fa-heart\"\n    }, null, -1 /* CACHED */)), $data.loading[item.id] ? (_openBlock(), _createElementBlock(\"span\", _hoisted_13)) : _createCommentVNode(\"v-if\", true), _cache[2] || (_cache[2] = _createTextVNode(\" 取消收藏 \", -1 /* CACHED */))], 8 /* PROPS */, _hoisted_12)])])])]);\n  }), 128 /* KEYED_FRAGMENT */))])) : !$data.loadingFavorites ? (_openBlock(), _createElementBlock(\"div\", _hoisted_14, [_cache[4] || (_cache[4] = _createElementVNode(\"i\", {\n    class: \"fas fa-heart text-danger fa-3x mb-3\"\n  }, null, -1 /* CACHED */)), _cache[5] || (_cache[5] = _createElementVNode(\"p\", null, \"您还没有收藏任何商品\", -1 /* CACHED */)), _createVNode(_component_router_link, {\n    to: \"/\",\n    class: \"btn btn-primary mt-2\"\n  }, {\n    default: _withCtx(() => [...(_cache[3] || (_cache[3] = [_createTextVNode(\"去浏览商品\", -1 /* CACHED */)]))]),\n    _: 1 /* STABLE */\n  })])) : (_openBlock(), _createElementBlock(\"div\", _hoisted_15, [...(_cache[6] || (_cache[6] = [_createElementVNode(\"div\", {\n    class: \"spinner-border text-primary\",\n    role: \"status\"\n  }, [_createElementVNode(\"span\", {\n    class: \"sr-only\"\n  }, \"Loading...\")], -1 /* CACHED */), _createElementVNode(\"p\", {\n    class: \"mt-2\"\n  }, \"加载中...\", -1 /* CACHED */)]))]))])])]);\n}","map":{"version":3,"names":["class","_createElementBlock","_hoisted_1","_createElementVNode","_hoisted_2","_hoisted_3","_createCommentVNode","$data","favorites","length","_hoisted_4","_Fragment","_renderList","item","key","id","_hoisted_5","src","image_path","alt","title","_hoisted_7","_hoisted_8","_toDisplayString","_hoisted_9","price","_hoisted_10","$options","formatDate","created_at","_hoisted_11","_createVNode","_component_router_link","to","name","params","_cache","onClick","$event","removeFavorite","disabled","loading","_hoisted_13","loadingFavorites","_hoisted_14","_hoisted_15","role"],"sources":["D:\\21626\\MyFiles\\files\\2025fall\\SE\\Vue_2\\frontend\\src\\views\\Favorites.vue"],"sourcesContent":["<template>\n  <div class=\"container\">\n    <div class=\"card mt-5\">\n      <div class=\"card-header bg-primary text-white\">\n        <h4 class=\"mb-0\">我的收藏</h4>\n      </div>\n      <div class=\"card-body\">\n        <!-- 收藏列表 -->\n        <div class=\"row\" v-if=\"favorites.length > 0\">\n          <div class=\"col-md-4 mb-4\" v-for=\"item in favorites\" :key=\"item.id\">\n            <div class=\"card item-card\">\n              <img \n                :src=\"item.image_path ? `/static/${item.image_path}` : '/static/images/default.jpg'\" \n                class=\"card-img-top item-image\" \n                :alt=\"item.title\"\n              >\n              <div class=\"card-body\">\n                <h5 class=\"card-title\">{{ item.title }}</h5>\n                <p class=\"card-text text-danger font-weight-bold\">¥{{ item.price }}</p>\n                <p class=\"card-text text-muted\">{{ formatDate(item.created_at) }}</p>\n                <div class=\"d-flex gap-2\">\n                  <router-link \n                    :to=\"{ name: 'ItemDetail', params: { id: item.id } }\" \n                    class=\"btn btn-primary btn-sm-1\"\n                  >\n                    查看详情\n                  </router-link>\n                  <button \n                    class=\"btn btn-outline-danger btn-sm\"\n                    @click=\"removeFavorite(item.id)\"\n                    :disabled=\"loading[item.id]\"\n                  >\n                    <i class=\"fas fa-heart\"></i>\n                    <span v-if=\"loading[item.id]\" class=\"spinner-border spinner-border-sm ml-1\"></span>\n                    取消收藏\n                  </button>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n        \n        <div class=\"alert alert alert-info text-center py-5\" v-else-if=\"!loadingFavorites\">\n          <i class=\"fas fa-heart text-danger fa-3x mb-3\"></i>\n          <p>您还没有收藏任何商品</p>\n          <router-link to=\"/\" class=\"btn btn-primary mt-2\">去浏览商品</router-link>\n        </div>\n        \n        <div class=\"text-center py-5\" v-else>\n          <div class=\"spinner-border text-primary\" role=\"status\">\n            <span class=\"sr-only\">Loading...</span>\n          </div>\n          <p class=\"mt-2\">加载中...</p>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport axios from '../axios';\n\nexport default {\n  data() {\n    return {\n      favorites: [],\n      loadingFavorites: true,\n      loading: {}\n    };\n  },\n  mounted() {\n    this.loadFavorites();\n  },\n  methods: {\n    async loadFavorites() {\n      this.loadingFavorites = true;\n      try {\n        const res = await axios.get('/favorites');\n        if (res.ok) {\n          this.favorites = res.data;\n        }\n      } catch (error) {\n        console.error('加载收藏列表失败', error);\n        this.$message.error('加载收藏列表失败');\n      } finally {\n        this.loadingFavorites = false;\n      }\n    },\n    async removeFavorite(itemId) {\n      this.loading[itemId] = true;\n      try {\n        await axios.delete(`/favorites/${itemId}`);\n        this.$message.success('取消收藏成功');\n        // 从列表中移除\n        this.favorites = this.favorites.filter(item => item.id !== itemId);\n      } catch (error) {\n        console.error('取消收藏失败', error);\n        this.$message.error('取消收藏失败');\n      } finally {\n        this.loading[itemId] = false;\n      }\n    },\n    formatDate(dateString) {\n      if (!dateString) return '';\n      const date = new Date(dateString);\n      return date.toLocaleDateString();\n    }\n  }\n};\n</script>\n\n<style scoped>\n.item-card {\n  transition: transform 0.2s;\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n}\n.item-card:hover {\n  transform: translateY(-5px);\n  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);\n}\n.item-image {\n  height: 200px;\n  object-fit: cover;\n}\n.card-body {\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n}\n.card-title {\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n}\n</style>\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}